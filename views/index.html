<!--
  Oversight.io, an ode the US government's oversight community.

  Built and maintained by Eric Mill. (@konklone, konklone.com)

  A Node app, with Express for a web server, and Elasticsearch
  for persistence. Open source, under a GPLv3 license:
  https://github.com/konklone/oversight

  This app would be entirely impossible without the public domain,
  volunteer-driven project to gather IG reports in bulk:
  https://github.com/unitedstates/inspectors-general

  Thanks to Lindsay Young, Travis Briggs, David Cook, Steve Pulec,
  Andrew Dai, and any contributors to that project not listed here.
-->

<!doctype html>
<html>
<head>
<title>
  Oversight.io | Celebrating the US government's oversight community.
</title>
</head>
<body>

<h1>Oversight.io</h1>

<% if (query) { %>
  <strong>Searching for "<%= query %>"...</strong>
<% } %>

<% if (results) { %>
  <ul>
    <% for (var i=0; i<results.length; i++) { %>
      <% report = results[i]._source %>
      <% highlight = results[i].highlight %>
      <li>
        <h2><%= report.title %></h2>
        <h4>
          <a href="<%= report.inspector_url %>">
            <%= report.agency_name %>
          </a>
        </h4>
        <p>
          <% if (highlight && highlight.text) { %>
            <%- helpers.truncate(highlight.text[0], 500) %>
          <% } else if (highlight && highlight.summary) { %>
            <%- helpers.truncate(highlight.summary[0], 500) %>
          <% } else { %>
            No excerpt available.
          <% } %>
        </p>
        <div class="links">
          <% if (report.url) { %>
            <a href="<%= report.url %>">Report</a>
            <% if (report.file_type == "pdf") { %>
              (PDF)
            <% } %>
          <% } else if (report.unreleased) { %>
            <% if (report.missing) { %>
              Unreleased/Missing
            <% } else { %>
              Unreleased
            <% } %>
          <% } %>
          |
          <% if (report.landing_url) { %>
            <a href="<%= report.landing_url %>">Summary</a>
          <% } %>
        </div>
      </li>
    <% } %>
  </ul>
<% } else { %>
  <p>
    No results right now.
  </p>
<% } %>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-252618-18', 'oversight.io');
  ga('send', 'pageview');

  // Anonymize user IPs (cut off the last triplet). Privacy first.
  ga('set', 'anonymizeIp', true);
</script>

</body>
</html>